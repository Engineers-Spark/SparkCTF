#!/usr/bin/env python3

"""
Author : msalaani
Task : DaRuuuk - Task
Event : SparkCTF

"""

from Crypto.Util.number import bytes_to_long as b2l, \
	getPrime, isPrime
from random import randint
from sympy import nextprime

try:
	from secret import FLAG, rnd
except ImportError:
	FLAG = b"SparkCTF{50M3_L33t_5tr1nG}"
	rnd = 1

def primoral(n):
	p = 1
	pp = 1
	for _ in range(n):
		pp = nextprime(pp)
		p *= pp
	return p

def genPrime(M):
	while True:
		k = randint(2 ** 36, 2 ** 37 - 1)
		a = randint(2 ** 20, 2 ** 62 - 1)
		g = getPrime(32)
		p = k * M**2 + pow(a, g, M)
		
		if isPrime(p):
			return p

M = primoral(rnd)
p, q = [genPrime(M) for _ in "  "]

n = p * q
e = 0x10001

c = pow(b2l(FLAG), e, n)

print(f"{n = }")
print(f"{e = }")
print(f"{c = }")

"""
n = 72640880077785722346240240334619929139129553596377591100001722489160671635250722021613382494887379784700791763705116894086502575324353334170510073938526418894108454186634983159678533952821324344011594321851033505643510870977188586553098829920793522608145320968408894587635444416882917641117438769988189245591203437460906339214842782558123385289293840394091522361354947441633841359591625714158871256304612215763174942730052645883960940040438630926752237861746786725715896184101325020667721962238198770414622059683807036201415660742143811335336541550373197347280899366882496830777727043521563179127515340176646359272885957935364580920337
e = 65537
c = 4290972039607040064135260059036248547780308577415963063134971929534869164575008258116644575940892801079111113386225526996392499534002309195651572076472651225732819520040340418359649446281124161914044143817248760528496447241388344481583987121596934703624395597542176305055987798237405101717790736910268426833505177293712649480693719113443556040596691866212928433738935920803290594817100072437733527972074311346827042290613760935560095857871435925382983293198808135923979761135094262114557646254259432491949000603011962320422461134837848913325003022405513754913170142374866176185291928974763417372986544042224378274943415998156752935555
"""
